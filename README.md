# 文字檔案拖拽工具

一個基於Python和Tkinter開發的GUI應用程式，支援拖拽文字檔案並顯示其內容。

![程式示意圖](img/demo.png)

## 功能特色

### 🎯 主要功能
1. **拖拽支援** - 支援將文字檔案拖拽到程式視窗
2. **檔案列表管理** - 顯示已新增的檔案列表
3. **文字內容顯示** - 在可滾動的文字區域中顯示檔案內容
4. **檔案操作** - 支援刪除和復原檔案
5. **內容複製** - 一鍵複製所有文字內容到剪貼簿
6. **多語言支援** - 支援中文和英文介面切換

### 📁 支援的檔案格式
- 程式語言檔案：`.py`, `.cpp`, `.c`, `.h`, `.java`, `.js`, `.php`, `.go`, `.rs` 等
- 標記語言檔案：`.html`, `.xml`, `.md`, `.rst`, `.yaml` 等
- 設定檔案：`.ini`, `.cfg`, `.conf`, `.json` 等
- 文字檔案：`.txt`, `.log` 等
- 腳本檔案：`.sh`, `.bat`, `.ps1` 等

## 安裝需求

### 系統需求
- Windows 10/11
- Python 3.7+

### 依賴套件
```bash
pip install -r requirements.txt
```

主要依賴：
- `tkinterdnd2` - 拖拽功能支援
- `pyperclip` - 剪貼簿操作

## 使用方法

### 啟動程式
```bash
python main.py
```

### 基本操作

#### 1. 新增檔案
- 將文字檔案從檔案總管拖拽到程式視窗的任何位置
- 支援的檔案會自動新增到左側列表
- 檔案內容會顯示在右側文字區域

#### 2. 管理檔案列表
- **選擇檔案**：點擊列表中的檔案名稱
- **刪除檔案**：選中檔案後點擊「刪除選中」按鈕，或雙擊檔案
- **復原檔案**：點擊「復原」按鈕恢復最後刪除的檔案
- **清空列表**：點擊「清空」按鈕移除所有檔案

#### 3. 文字內容操作
- **複製內容**：點擊「複製內容」按鈕將所有文字複製到剪貼簿
- **清空內容**：點擊「清空內容」按鈕清除文字顯示區域

#### 4. 語言切換
- **語言選擇**：點擊右上角的語言下拉選單
- **支援語言**：中文（繁體）和英文
- **即時切換**：選擇語言後介面立即更新

### 介面說明

```
┌─────────────────────────────────────────────────────────────┐
│                文字檔案拖拽工具                [語言: 中文 ▼] │
├─────────────────┬───────────────────────────────────────────┤
│   檔案列表      │              文字內容                     │
│ ┌─────────────┐ │ ┌───────────────────────────────────────┐ │
│ │ file1.py    │ │ │ === file1.py ===                     │ │
│ │ file2.txt   │ │ │ print("Hello World")                 │ │
│ │ file3.md    │ │ │                                       │ │
│ │             │ │ │ === file2.txt ===                    │ │
│ └─────────────┘ │ │ This is a text file...               │ │
│ [刪除][復原][清空] │ └───────────────────────────────────────┘ │
│                 │ [複製內容] [清空內容]    行數: 25, 字元數: 512 │
├─────────────────┴───────────────────────────────────────────┤
│ 狀態：拖拽文字檔案到此視窗以新增到列表                        │
└─────────────────────────────────────────────────────────────┘
```

## 程式架構

### 目錄結構
```
drag_n_paste/
├── main.py                 # 主程式入口
├── requirements.txt        # 依賴套件
├── README.md              # 說明文件（中文）
├── README_EN.md           # 說明文件（英文）
├── docs.md                # 文檔索引頁面
├── CHANGELOG.md           # 更新日誌
├── install.bat            # Windows安裝腳本
├── run.bat               # Windows啟動腳本
├── img/                   # 圖片資源
│   └── demo.png          # 程式示意圖
├── test_sample/           # 測試檔案
│   ├── test_chinese.txt   # 中文測試檔案
│   ├── test_sample.py     # Python測試檔案
│   └── test_sample.txt    # 文字測試檔案
├── core/                  # 核心功能模組
│   ├── file_handler.py    # 檔案處理
│   └── file_validator.py  # 檔案驗證
├── gui/                   # GUI元件模組
│   ├── main_window.py     # 主視窗
│   ├── file_list_widget.py # 檔案列表元件
│   ├── text_display_widget.py # 文字顯示元件
│   └── language_selector.py # 語言選擇元件
└── utils/                 # 工具模組
    ├── constants.py       # 常數定義
    └── i18n.py           # 國際化翻譯模組
```

### 設計原則
- **原子化**：每個檔案只提供一個基本功能
- **樹狀結構**：使用資料夾進行模組化管理
- **低耦合**：適當拆解耦合，降低模組間依賴
- **觀察者模式**：語言切換使用觀察者模式，避免硬編碼

## 特色功能

### 🔄 智慧檔案處理
- 自動檢測檔案編碼（UTF-8、GBK、Big5等）
- 支援多種文字檔案格式
- 重複檔案檢測
- Unicode字元完整支援

### 🎨 使用者友善介面
- 現代化的GUI設計
- 可調整的分割視窗
- 即時狀態回饋
- 滾動條支援
- 多語言介面（中文/英文）
- 觀察者模式實現即時語言切換

### 📋 便利的操作
- 拖拽檔案新增
- 一鍵複製所有內容
- 復原刪除功能
- 批次清空操作

## 故障排除

### 常見問題

**Q: 拖拽檔案沒有反應？**
A: 請確認：
- 檔案是支援的文字格式
- 檔案沒有被其他程式鎖定
- 檔案路徑不包含特殊字元

**Q: 檔案內容顯示亂碼？**
A: 程式會自動嘗試多種編碼，如果仍有問題，請確認檔案編碼是否為常見格式。

**Q: 複製功能無法使用？**
A: 請確認已安裝 `pyperclip` 套件，並且系統剪貼簿功能正常。

## 快速開始

1. **安裝依賴**：
   ```bash
   .\install.bat
   ```

2. **啟動程式**：
   ```bash
   .\run.bat
   # 或
   python main.py
   ```

3. **測試功能**：
   - 拖拽 `test_sample/test_chinese.txt` 測試Unicode字元支援
   - 拖拽 `test_sample/test_sample.py` 測試程式碼檔案支援
   - 使用右上角下拉選單切換語言

## 版本歷史

詳細版本歷史請參閱 [CHANGELOG.md](CHANGELOG.md)。

## 相關連結

- [English Documentation (英文說明文件)](README_EN.md)
- [更新日誌 (Changelog)](CHANGELOG.md)

## 授權

本專案採用 MIT 授權條款。

## 貢獻

歡迎提交 Issue 和 Pull Request 來改善這個專案！ 